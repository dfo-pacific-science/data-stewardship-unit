{
  "hash": "5594b868d1a461a80b09f3a469901225",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Access Data in SharePoint from R\"\nformat: html\nredirect_from:\n  - /documentation_hub/how_to_guides/sharepoint_r.qmd\nexecute:\n  eval: false\n---\n\n### Why Connect to Sharepoint?\nConnecting R to Sharepoint enables secure, programmatic data access for reproducible analysis workflows. This is especially useful to data stewards and scientists who want to move away from email and personal hard-drive based data storage and sharing and instead use a cloud service as a central repository for data.\n\nThis is particularly useful for data management tasks in Sharepoint, such as:\n\n* Downloading data files for analysis\n* Uploading processed data files\n* Managing document libraries and folders\n* Automating data workflows\n\n::: {.callout-warning}\nKeep in mind, to access the DFO Sharepoint from R using the methods below you need to be on the DFO network or using the VPN.\n:::\n\n### Using the Microsoft365 Package\n\nIt's possible to access data in SharePoint, including DFO's SharePoint and others, from R using the `Microsoft365R` package. This package allows you to authenticate and interact with SharePoint sites, document libraries, and files. \n\n\n\n### Example: Accessing SharePoint Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Install the Microsoft365R package if you haven't already\ninstall.packages(\"Microsoft365R\")\n\n# Load the Microsoft365R package\nlibrary('Microsoft365R')\nlibrary('dplyr')\n\n# Clear you cache of authentication tokens if you have issues\n# Comment this out if you don't want to clear your tokens\n#AzureAuth::clean_token_directory()\n\n# Get the SharePoint site you want to work with using either the name of the SharePoint site or id or URL\nsite <- get_sharepoint_site('Fishery & Assessment Data Section Wiki')\n\n# list the document libraries in the SharePoint site\nsite$list_drives()\n```\n:::\n\n\nRunning the above code will prompt an authentication process with Azure Active Directory. You may be prompted to sign in with your browser. After signing in successfully, you will see the message `Authenticated with Azure Active Directory. Please close this page and return to R.`\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get the default document library for the SharePoint site\ndrv <- site$get_drive()\n\n# Download file from FADS Wiki SharePoint\ndrv$download_file(\"General/FSAR Data/Fraser Pinks/data/generated/benchmarks.csv\", overwrite = TRUE)\n\n# Alernatively, you can load data from SharePoint directly as an R dataframe without downloading it locally. This is useful for large files or when you want to avoid cluttering your local storage.\n# This will load the file as a dataframe directly into R\nfr_pk_bms_not_downloaded <- drv$load_dataframe(\"General/FSAR Data/Fraser Pinks/data/generated/benchmarks.csv\")\n\nfr_pk_bms <- readr::read_csv(\"benchmarks.csv\")\n\n# Now do whatever data wrangling you need to do with the data! \n# For example, let's add a column just for demonstration\nfr_pk_bms <- fr_pk_bms |>\n  mutate(new_column = \"This is a new column\")\n\n\n# Save the modified data to a new CSV file\nwrite.csv(fr_pk_bms, \"benchmarks_modified.csv\", row.names = FALSE)\n```\n:::\n\n\nYou will also want to upload data to SharePoint, whether it's an updated file or a new output. This can be done using the `save_dataframe` function.\n\nLets upload the modified file we just created to the SharePoint site.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Upload and update a file to the SharePoint site\ndrv$save_dataframe(fr_pk_bms, \"General/FSAR Data/Fraser Pinks/data/generated/benchmarks.csv\")\n\n# Check if the file was uploaded successfully\nuploaded_file <- drv$load_dataframe(\"General/FSAR Data/Fraser Pinks/data/generated/benchmarks.csv\")\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Print the file details\nprint(uploaded_file)\n```\n:::\n\n\n\n## Conclusion\n\nThis enables secure, programmatic data access for reproducible analysis workflows. Using the `Microsoft365R` package, you can easily access and manage data in SharePoint from R. This allows for a more streamlined and efficient workflow, especially for data stewards and scientists who work with large datasets and need to collaborate with others.\n\nThis approach can help you automate data management tasks, reduce reliance on email and personal storage, and improve collaboration within your team.\n\n## Additional Resources\n\n- [Microsoft365R Documentation](https://cran.r-project.org/web/packages/Microsoft365R/Microsoft365R.pdf)\n\n\n",
    "supporting": [
      "sharepoint_r_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}